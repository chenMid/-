<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="wakoo.fun.mapper.AgentMapper">
    <insert id="addAgent">
        INSERT INTO agent_management (name, contact_phone, email, address,create_time,longitude, latitude,status)
        VALUES (#{name}, #{contactPhone}, #{email}, #{address},NOW(),#{longitude}, #{latitude},#{status})
    </insert>
    <update id="updRegent">
        UPDATE agent_management SET `name`=#{agent.name},contact_phone=#{agent.contactPhone},
        email=#{agent.email},address=#{agent.address},status=#{agent.status},longitude=#{agent.longitude},latitude=#{agent.latitude} WHERE id=#{agent.id}
    </update>
    <select id="listAdcert" resultType="wakoo.fun.pojo.Agent">
        SELECT id, name, contact_phone, email, address, `status`, creation_time, longitude, latitude
        FROM agent_management
        WHERE
            id LIKE CONCAT('%', #{keyword}, '%') OR
            name LIKE CONCAT('%', #{keyword}, '%') OR
            contact_phone LIKE CONCAT('%', #{keyword}, '%') OR
            email LIKE CONCAT('%', #{keyword}, '%') OR
            address LIKE CONCAT('%', #{keyword}, '%') OR
            creation_time LIKE CONCAT('%', #{keyword}, '%')
    </select>
    <select id="isEmailDuplicated" resultType="java.lang.Integer">
        SELECT count(email)
        FROM agent_management
        WHERE email=#{email}
    </select>
    <select id="isUsernameDuplicated" resultType="java.lang.Integer">
        SELECT count(name)
        FROM agent_management
        WHERE `name`=#{name}
    </select>
    <select id="isContactPhone" resultType="java.lang.Integer">
        SELECT count(contact_phone)
        FROM agent_management
        WHERE `contact_phone`=#{phone}
    </select>
    <select id="retrieveProxyInfo" resultType="wakoo.fun.pojo.Agent">
        SELECT
            id,`name`,contact_phone,email,address,status,longitude,latitude
        FROM
            agent_management
        WHERE
            id = #{getProxyId}
    </select>
</mapper>