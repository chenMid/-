<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="wakoo.fun.mapper.AdvertMapper">
    <insert id="addAdver">
        INSERT INTO advert(advert_name,content,img,status,sort,createtime,updatetime)
        VALUES(#{avatar.advertName},#{avatar.content},#{avatar.img},#{avatar.status},#{avatar.sort},now(),now())
    </insert>
    <insert id="addCarousel">
        INSERT INTO carousel (image_url, title, description, link_url, order_number)
        VALUES (#{carousel.imageUrl}, #{carousel.title},#{carousel.description},#{carousel.linkUrl},#{carousel.orderNumber});
    </insert>
    <update id="updAvate">
        UPDATE advert SET advert_name = #{Advert.advertName},content = #{Advert.content},img = #{Advert.content},updatetime = NOW() WHERE id = #{Advert.id};
    </update>
    <update id="updAvateStatus">
        UPDATE advert
        <set>
            <if test="status==1">status=0</if>
            <if test="status==0">status=1</if>
        </set>
        WHERE id=#{id}
    </update>
    <select id="getAvate" resultType="wakoo.fun.dto.AdvertDto">
        SELECT id, advert_name, content, img, sort, status, createtime, updatetime
        FROM Advert
        WHERE advert_name LIKE CONCAT('%', #{keyword}, '%') OR
            content LIKE CONCAT('%', #{keyword}, '%') OR
            img LIKE CONCAT('%', #{keyword}, '%') OR
            sort LIKE CONCAT('%', #{keyword}, '%') OR
            status LIKE CONCAT('%', #{keyword}, '%') OR
            createtime LIKE CONCAT('%', #{keyword}, '%') OR
            updatetime LIKE CONCAT('%', #{keyword}, '%')
    </select>
    <select id="getIsAvate" resultType="wakoo.fun.Vo.AdvertDtoVo">
        SELECT id,advert_name,content,img,sort FROM advert WHERE id=#{id}
    </select>
    <select id="getOrderNumber" resultType="java.lang.Integer">
        SELECT COUNT(order_number) FROM carousel WHERE order_number=#{orderNumber}
    </select>
</mapper>